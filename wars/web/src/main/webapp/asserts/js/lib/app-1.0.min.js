!function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){r(1),r(2),r(3),r(4),r(5),r(6),r(7),r(8),r(9),r(10),r(11),r(12),r(13),r(14),e.exports=r(15)},function(e,t){!function(e){"use strict";e.youi=e.youi||{},e.extend(e.youi,{designerUtils:{buildItemTreeNodes:function(t,r,i){return function(t,r,i){var n={},o=[];return e(t).each(function(){var t=e.extend({},this);e.isFunction(r)&&r(t);var s=this.level?parseInt(this.level):i;if(s==i)o.push(t);else if(s>i){var a=n[s-1+""];a&&(a.children=a.children||[],a.children.push(t),a.expanded=!0)}n[this.level]=t}),o}(t,r,i||0)},parseItemsFromTreeNode:function(t,r){return function t(r,i,n){var o=[],i=i||0;var s=n?"."+n:"";e(">ul>li.treeNode"+s,r).each(function(){var r=e(this),s=e.extend({id:r.attr("id")},r.data(),{text:e.youi.treeUtils.getNodeText(r),level:i});delete s.group,o.push(s),o=o.concat(t(r,i+1,n))});return o}(t,0,r)},parseTreeNodeItemList:function(t,r){return function(t,r){var i=[];return e("li.treeNode"+(r?"."+r:""),t).each(function(){var t=e(this),r=e.extend({id:t.attr("id")},t.data(),{text:e.youi.treeUtils.getNodeText(t)});delete r.group,i.push(r)}),i}(t,r)},getFormFieldStrValue:function(t,r){if(!t||!r)return"";var i=t[r];return e.isArray(i)&&(0==i.length&&i.push(""),i=i[0]),i}},itemUtils:{insertItem:function(e,t,r){return[].concat(e.slice(0,r)).concat([t]).concat(e.slice(r,e.length))},removeItem:function(e,t){var r=[].concat(e.slice(0,t));return t!=e.length-1&&(r=r.concat(e.slice(t+1,e.length))),r},removeItemById:function(e,t){for(var r=[],i=0;i<e.length;i++)e[i].id!=t&&r.push(e[i]);return r},findItemIndexes:function(t,r){var i={};if(e.isArray(t)&&e.isArray(r))for(var n=0;n<t.length;n++)-1!=e.inArray(t[n].id,r)&&(i[t[n].id]=n);return i},findInsertIndex:function(t,r,i){var n;r?n=e.youi.itemUtils.findItemIndexes(t,[r])[r]+i+1:n=t.length;return n}},sheetEditor:{insertCol:function(e,t){this._proxySheetAreaAction("insertCol")},appendCol:function(e,t){this._proxySheetAreaAction("appendCol")},appendBlankCol:function(e,t){this._proxySheetAreaAction("appendBlankCol")},deleteCol:function(e,t){this._proxySheetAreaAction("deleteCol")},setTextIndent:function(e,t){this._proxySheetCommandAction("setTextIndent",e,t)},setAlign:function(e,t){this._proxySheetCommandAction("setAlign",e,t)},setFontSize:function(e,t){this._proxySheetCommandAction("setFontSize",e,t)},setBorder:function(e,t){this._proxySheetCommandAction("setBorder",e,t)},mergeArea:function(e,t){this._proxySheetCommandAction("mergeArea",e,t)},setSequence:function(e,t){this._proxySheetCommandAction("setSequence",e,t)},clearArea:function(t,r){e.youi.messageUtils.confirm("确认清除选区文本信息?",this._proxy("_proxySheetCommandAction","clearAreaText",t,r))},moveAreaText:function(e,t){var r=parseInt(t.value),i=this.contentElem.sheet("getSelectedArea");this.contentElem.sheet("moveArea",i,r)},_proxySheetAreaAction:function(e){var t=this.contentElem.sheet("getSelectedArea");this.contentElem.sheet(e,t)},_proxySheetCommandAction:function(e,t,r){var i=this.contentElem.sheet("getSelectedArea");if("mergeCellText"==r.value){var n=this.contentElem.sheet("getSelectedTexts");this.contentElem.sheet("setCellText",{rowIndex:i.startRow,colIndex:i.startCol,text:n.join("")})}this.contentElem.sheet(e,t,r,i)}},abstractDesigner:e.extend({},e.youi.command,{options:{useModelTree:!0},_initContent:function(t){this.UUID=0,this.contentElem=this.element.find(">."+this.widgetName+"-content:first").addClass("auto-height"),e.isFunction(t)&&t(this.contentElem)},_initRefWidget:function(){this._initSubPages(),this._initModelTree()},_initModelTree:function(){var t,r;t=this.options.useModelTree,r=this.options.refs,t&&e.isArray(r)&&r.length>0&&(this.modelTreeElem=e("#"+this.options.refs[0]),this.modelTreeElem.hasClass("youi-tree")?(this._bindTreeMenuAction(),this.element.parents(".youi-treePage").length||(window[this.options.refs[0]+"_select"]=this._proxy("_treeNodeSelect"))):this.modelTreeElem=null)},_treeNodeSelect:function(e){},_bindTreeMenuAction:function(){var t=[],r=this.modelTreeElem.data("xmenu");r&&e("#"+r).find("li.youi-xmenuitem[data-name]").each(function(){t.push(e(this).data("name"))});for(var i=0;i<t.length;i++){var n=this.options.refs[0]+"_xmenu_"+t[i];if(!e.isFunction(window[n])&&(window[n]=this._proxy(t[i]),0==t[i].indexOf("open"))){var o=t[i].substring(4,5).toLocaleLowerCase()+t[i].substring(5);this.subPages[o]&&!e.isFunction(this[t[i]])&&(this[t[i]]=this._proxy("openSubPageByMenu",o))}}},_refreshModelTree:function(t,r){if(this.modelTreeElem&&this.modelTreeElem.length){var i=this.modelTreeElem.find("ul:first").empty(),n=[];e(t).each(function(){var t={};if(r)for(var i in r)this[i]&&r[i]&&(t[r[i]]=this[i]);n.push(e.youi.treeUtils.treeNodeHtml(this.id,this.text,t,{children:this.children,group:this.group}))}),i.html(n.join(""))}},_treeNodeMoveDown:function(){var e=this.modelTreeElem.tree("getSelected"),t=e.next("li.treeNode");if(t.length)return t.after(e),e},_treeNodeMoveUp:function(){var e=this.modelTreeElem.tree("getSelected"),t=e.prev("li.treeNode");if(t.length)return t.before(e),e},_treeNodeMoveLeft:function(){var e,t=this.modelTreeElem.tree("getSelected"),r=t.parents("li.treeNode:first");r.length&&(r.after(t),(e=r)&&(0==e.find(">ul>li").length?e.removeClass("expandable"):e.addClass("expandable")))},_treeNodeMoveRight:function(){var t=this.modelTreeElem.tree("getSelected"),r=t.prev("li.treeNode");if(r.length){this.modelTreeElem.tree("addNode",r,"temp_","temp_"),r.find(">ul>li:last").remove();var i=r.find(">ul");0==i.length&&(i=e("<ul></ul>").appendTo(r)),i.append(t)}},_updateTreeNode:function(t,r,i,n,o){e.isArray(t)&&(t=t[0]);var s=this.modelTreeElem.find(".treeNode."+r+"[data-id="+t+"]");for(var a in i&&s.find(">span>a").text(i),o&&this._setTreeNodeToolTips(s,o),n=n||{}){var l=n[a];if(e.youi.stringUtils.notEmpty(l)){var d="data-"+e.youi.stringUtils.convertDataProperty(a,"-");s.attr(d,l).data(a,l)}}return s},_removeTreeNode:function(e){this.modelTreeElem.tree("removeNode",e)},_setTreeNodeToolTips:function(e,t){t=t||"";var r=e.find(">.tree-span>span.tree-node-hint");0!=r.length?r.text(t):e.find(">.tree-span").append("<span class='tree-node-hint'>"+t+"</span>")},_buildChildItem:function(e){var t={};return e&&e.id&&(t.parentId=e.id,t.parentText=e.text),t},_addItemTreeNode:function(e,t,r,i){var n,o=e.parentId,s=0,a=["item",t];return o&&(s=(n=this.modelTreeElem.find(".treeNode."+t+"[data-id="+o+"]")).find(".treeNode."+t).length),n&&n.length||(n=this.modelTreeElem.find(".treeNode."+t+"-parent:first")),e.id=this._genUUID(i||"M",this.modelTreeElem),r&&(a=a.concat(r)),this.modelTreeElem.tree("addNode",n,e.id,e.text,{id:e.id,"mapped-id":e.mappedId,expression:e.expression},{tooltips:e.mappedId,group:a.join(" ")}),s},_addTreeNode:function(e,t,r,i,n,o){var s=[e.attr("id")];this.modelTreeElem.tree("visitParents",e,function(e){s.push(e.getAttribute("id"))}),s.reverse(),this.modelTreeElem.tree("openPath",s.join("/")+"/").tree("addNode",e,o||this._genUUID(t,this.modelTreeElem),r,i,n||{})},_initSubPages:function(){if(this.subPages=[],e.isArray(this.options.refs))for(var t=0;t<this.options.refs.length;t++){var r=this.options.refs[t].split("_subpage_");if(2==r.length){var i=r[1];this.subPages[i]={subPageId:this.options.refs[t]};var n="P_"+this.options.refs[t]+"_form_afterSubmit";e.isFunction(window[n])||(window[n]=this._proxy("_afterSubmitSubPage",{name:i}))}}},openSubPageByMenu:function(t,r,i){var n=e(t),o=n.parents(".treeNode:first"),s=o.data("id")?e.youi.treeUtils.getNodeText(o):"",a=e.extend({commandValue:r.value,text:e.youi.treeUtils.getNodeText(n),parentText:s,id:n.attr("id")},n.data()),l={record:a};this._openSubPage(i,l,a)},_openSubPage:function(t,r,i){if(this.subPages&&this.subPages[t]){var n=this.subPages[t].subPageId;e("#"+n).unbind("initPageData").bind("initPageData",this._proxy("_initPageData",r,t)).subpage("open",{},{},e.extend({},i,{subPageId:n}))}},_initPageData:function(t,r,i,n){if(i&&r&&e.isFunction(window[r.callback])){var o=null,s="_"+n+"FormRecord";e.isFunction(this[s])&&(o=this[s](i.record)),o=e.extend({},r.record,o||i.record);var a="P_"+this.subPages[n].subPageId+"_form";e("#"+a).form("reset").form("fillRecord",o),window[r.callback](o)}},_afterSubmitSubPage:function(t,r){var i=r.name;if(this.subPages&&this.subPages[i]){var n=this.subPages[i].subPageId;e("#"+n).dialog("close");var o="_"+i+"AfterFormSubmit";e.isFunction(this[o])&&this[o](t.record)}},_destroyDesigner:function(){this.model=null,this.contentElem=null,this.modelTreeElem=null,this.subPages=[]},_genUUID:function(e,t){e=e||"",t=t||this.contentElem||this.element;var r=e+this.UUID++;return t.find("#"+r).length?this._genUUID(e,t):r},setDirty:function(){this.element.attr("data-dirty","1")},isDirty:function(){return"1"===this.element.attr("data-dirty")},removeDirty:function(){this.element.removeAttr("data-dirty")},_resizeHeight:function(){var t=this.element.innerHeight();if(t>0){var r=0;this.element.find(">.fixed-height").each(function(){r+=e(this).outerHeight()}),this.element.find(">.auto-height").height(t-r-10)}}})})}(jQuery)},function(e,t){var r;(r=jQuery).widget("youi.treePage",r.youi.abstractWidget,r.extend({},{options:{bindResize:!0},_initWidget:function(){this.contentElem=this.element.find(">.treePage-content:first").addClass("auto-height"),this.treeElem=r("#"+this.options.refs[0]),this.element.attr("data-hash",!0),window[this.options.refs[0]+"_select"]=this._proxy("_treeNodeSelect"),window[this.options.refs[0]+"_afterLoad"]=this._proxy("_treeAfterLoad"),this.element.trigger("pagehash",{init:!0,startPage:this._parsePageUrl()||this.options.startPage}),this._bindWidgetCommand(),this.options.contentWidget&&this.contentElem[this.options.contentWidget](this.options)},_parsePageUrl:function(){var e=window.location.hash,t=e.indexOf("###nodeId:");return t>-1?e.substring(t+"###nodeId:".length):null},_treeAfterLoad:function(e){this._callGloablFunc("afterLoad");var t=this.treeElem.data("openPath");t&&window.setTimeout(this._proxy("_openPath",t),200),this.treeElem.find("li.root").removeClass("expanded").removeClass("expandable")},loadTreeNodes:function(e){var t=[];if(e&&(r(e).each(function(){t.push(r.youi.treeUtils.treeNodeHtml(this.id,this.text,{group:this.group},this))}),this.treeElem.find(">ul").html(t.join("")),this.options.sourceStyle&&-1==window.location.hash.indexOf("treepage###"))){var i=this.treeElem.find(".treeNode."+this.options.sourceStyle+":first").attr("id");window.setTimeout(this._proxy("_openPath",i),100)}},_openPath:function(e){this.treeElem.tree("openPath",e)},_treeNodeSelect:function(e){var t=e.attr("id"),r=[];try{this.treeElem.tree("visitParents",e,function(e){r.push(e.getAttribute("id"))}),(r=r.reverse()).push(t),this.element.trigger("setpagehash",{hash:r.join("/"),partHash:"treePage"})}catch(e){console.log(e)}this._callGloablFunc("select",e)},_initAction:function(){this._on({pagehash:function(e,t){var r=window.location.hash;t.init&&-1==r.indexOf("?")&&(window.location.hash=window.location.hash+"?treepage");var i=r.indexOf("###nodeId:");if(i>-1){var n=r.substring(i+"###nodeId:".length),o=n.split("/"),s=o[o.length-1];this.treeElem.find("li.treeNode#"+s),t.init?(this.treeElem.attr("data-open-path",n),this.element.trigger("resize")):n&&this.treeElem.tree("openPath",n)}return!1},setpagehash:function(e,t){var r=window.location.hash;if(t.hash&&t.partHash){var i=r.indexOf("###nodeId:");window.location.hash=-1!=i?r.substring(0,i)+"###nodeId:"+t.hash:r+"###nodeId:"+t.hash}return!1}})},_afterLoadPage:function(){},loadHtml:function(e){this.contentElem.html(e)},loadPage:function(e){r.youi.pageUtils.loadPage(this.contentElem,e,this._proxy("_afterLoadPage"))},_resize:function(){this._resizePageHeight()}}))},function(e,t){
/*!
 * youi JavaScript Library v3.0.0
 *
 *
 * Copyright 2016-2020, zhyi_12
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Date: 2016-1-4
 */
!function(e){function t(e){for(var t="",r=e;r>0;){var i=r%26;0==i&&(i=26),t=String.fromCharCode(i+64)+t,r=(r-i)/26}return t}function r(t){var r=[],i=t.text;for(var n in delete t.text,delete t.rowIndex,delete t.colIndex,r.push("<td "),t.datas)e.youi.stringUtils.notEmpty(t.datas[n])&&r.push("data-"+e.youi.stringUtils.convertDataProperty(n)+'="'+t.datas[n]+'" ');for(var n in t)"string"==typeof t[n]&&e.youi.stringUtils.notEmpty(t[n])&&r.push(n+'="'+t[n]+'" ');return r.push(">"),r.push(i||""),r.push("</td>"),r.join("")}function i(t){var r={id:t.attr("id"),text:t.text()||t.find("input:first").val(),class:t[0].className,rowspan:t.attr("rowspan"),colspan:t.attr("colspan"),datas:{mergeId:t.attr("data-merge-id"),expression:t.attr("data-expression")}},i={textIndent:"0px",fontSize:"14px",color:"rgb(51, 51, 51)",backgroundColor:"rgba(0, 0, 0, 0)",textAlign:"start",borderTopColor:"rgb(192, 192, 192)",borderRightColor:"rgb(192, 192, 192)",borderBottomColor:"rgb(192, 192, 192)",borderLeftColor:"rgb(192, 192, 192)"};t.removeClass("selected");var n=[];for(var o in i){var s=t.css(o);s&&i[o]!=s&&n.push(e.youi.stringUtils.convertDataProperty(o)+":"+s)}return n.length&&(r.style=n.join(";")+";"),t[0].className=r.class,r}function n(e,t){return e-t}e.widget("youi.sheet",e.youi.abstractWidget,e.extend({},{options:{bindResize:!0,width:800,editable:!1,mode:"horizontal",expression:"records[{recordName}][{recordIndex}].items[{itemIndex}].values[valueIndex]"},_initWidget:function(){this._mouseInit(),this.tableDom=this.element.find("table")[0],this.element.addClass("page-editor");var t=this.options.xmenu||this.options.id+"_xmenu",r=e("#"+t);r.length&&(this.pasteHelper=e('<div class="paste-helper" style="position:absolute;z-index: -1;left:0px;top:0px;" contenteditable="true"></div>').insertBefore(this.element),this.options.xmenu=t,new ClipboardJS(r.find(".xmenu-item[data-name=copy]")[0],{text:this._proxy("_findCopyAreaText")}),this.pasteHelper.bind("paste",this._proxy("_paste",this.options.customPaste)),this.pasteHelper.bind("keypress",this._proxy("_copy")))},_copy:function(t){t.ctrlKey&&3==t.keyCode&&e("#"+this.options.xmenu).find(".xmenu-item[data-name=copy]").trigger("click")},_findCopyAreaText:function(e){return this.getSelectedTexts(!0).join("")},_paste:function(t,r){if(t&&t.originalEvent){e(t.currentTarget).empty();var i=t.originalEvent.clipboardData;i||(i=window.clipboardData);var n=i.getData("text");if(n){var o=n.replace(/\n|\r/g,"\t").split("\t");this.element.find(".cell.selected").each(function(t){var i=e(this);null==e.trim(o[t])||i.hasClass("readonly")||(e.isFunction(r)?r(i,o[t]):i.text(o[t]))})}}},_mouseStart:function(t){var r=e(t.target);r.hasClass("cell")?(this._clearSelectedArea(),this.dragElem=r,this.helper=this._createHelper()):r.is("span.cell-text")||r.hasClass("col-resize-handler")&&(this.dragElem=r.parent(),this.colResizeHelper=this._getResizeHelper().css({left:this.dragElem[0].offsetLeft+this.element.find(".pubHeader").outerWidth(),width:this.dragElem.outerWidth(),height:this.element.innerHeight()-10}).show())},_mouseDrag:function(t){var r=e(t.target);if(this.colResizeHelper){var i=this._computeHelperPos(t);this.colResizeHelper.width(i.width-25)}else if(this.dragElem){i=this._computeHelperPos(t);this.helper.css(i),r.hasClass("cell")&&(this.dropElem=r);var n=this.helper[0].offsetTop+this.helper.height()-this.element.height(),o=this.helper[0].offsetLeft+this.helper.width()-this.element.width();n>0&&this.element.scrollTop()<n&&n<e(this.tableDom).height()-this.element.height()+50&&this.element.scrollTop(n),o>0&&this.element.scrollLeft()<o&&this.element.scrollLeft(o)}},_mouseStop:function(e){this._colResizeStop(),this.dragElem&&this.dropElem&&this._showSelectedArea(this.dragElem,this.dropElem),this.helper&&this.helper.hide(),this.dropElem=null,this.dragElem=null},_colResizeStop:function(){this.colResizeHelper&&(this.dragElem.width(Math.max(this.colResizeHelper.width()+10,20)),this.colResizeHelper.hide(),this.colResizeHelper=null)},_getResizeHelper:function(t){var r=(t||"col")+"-resize-helper",i=this.element.find(">."+r);return i.length||(i=e('<div class="'+r+'">').appendTo(this.element)),i},_showSelectedArea:function(e,t){var r=this._cellAreaIter(e,t);this._selectCellsByArea(r),this.pasteHelper&&this.pasteHelper.focus()},_selectCellsByArea:function(t){var r=[];this._cellIter(t,function(t){var i="";t.hasClass("merged-cell")?i=t.attr("id"):t.hasClass("hide")&&(i=t.attr("data-merge-id")),i&&-1===e.inArray(i,r)&&r.push(i)}),r.length?this._showSelectedAreaWithMerge(t,r):this._addAreaSytle(t,"selected")},_showSelectedAreaWithMerge:function(e,t){if(t.length>0){for(var r=e.startRow,i=e.endRow,n=e.startCol,o=e.endCol,s=0;s<t.length;s++){var a=this.element.find("#"+t[s]);if(0!==a.length){var l=a.parent().prevAll().length,d=a.prevAll().length,c=parseInt(a.attr("rowspan")),h=parseInt(a.attr("colspan"));r=Math.min(r,l),i=Math.max(i,l+c-1),n=Math.min(n,d),o=Math.max(o,d+h-1)}}var u={startRow:r,endRow:i,rows:i-r+1,startCol:n,endCol:o,cols:o-n+1};this._needReSelectedArea(e,r,i,n,o)?this._selectCellsByArea(u):this._addAreaSytle(u,"selected")}},_needReSelectedArea:function(e,t,r,i,n){return e.startRow!==t||e.endRow!==r||e.startCol!==i||e.endCol!==n},getSelectedTexts:function(t){var r=[];return this.tableDom||(this.tableDom=this.element.find("table")[0]),this.tableDom&&e(".cell.selected",this.tableDom).each(function(){var i=e(this),n=e.trim(i.text());if(i.hasClass("dropdown")){var o=i.find("span:first");n=o.length?e.trim(o.text()):""}t&&(i.next(".selected").length?n+="\t":n+="\n"),r.push(n)}),r},_getSelectedAreaTexts:function(){var t=[[]];return this.tableDom||(this.tableDom=this.element.find("table")[0]),this.tableDom&&e(".cell.selected",this.tableDom).each(function(){var r=e(this),i=e.trim(r.text());if(r.hasClass("dropdown")){var n=r.find("span:first");i=n.length?e.trim(n.text()):""}t[t.length-1].push(i),r.next(".selected").length||t.push([])}),t},getSelectedRowTexts:function(){return this.getSelectedTexts(!0).join("").replace(/\t/g,"/").split("\n")},getSelectedColTexts:function(e){e=e||1;for(var t=this._getSelectedAreaTexts(),r=[],i=Math.min(t.length-1,e),n=0;n<t[0].length;n++){for(var o=[],s=0;s<i;s++)o.push(t[s][n]);r.push(o.join(""))}return r},_getAreaRecords:function(e){return this._cellAreaRecordsIter(e)},moveArea:function(t,r){for(var i=t.startRow;i<=t.endRow;i++){var n=e(this.tableDom.rows[i+1].cells[t.startCol-1]),o=e(this.tableDom.rows[i+1].cells[t.endCol+1]);r>0?n.before(o):r<0&&o.after(n)}},_cellAreaRecordsIter:function(t,r){var n=[];return this._cellIter(t,function(t,o,s,a){var l=e(t),d=e.extend({rowIndex:o,colIndex:s},i(l));e.isFunction(r)&&r(d,l,o,s,a),n.push(d)}),n},_cellAreaIter:function(t,r,i){var n=t.parent().prevAll().length,o=r.parent().prevAll().length,s=t.prevAll().length,a=r.prevAll().length,l={startRow:Math.min(n,o),endRow:Math.max(n,o),startCol:Math.min(s,a),endCol:Math.max(s,a),rows:Math.abs(n-o)+1,cols:Math.abs(s-a)+1};return e.isFunction(i)&&this._cellIter(l,i),l},_cellIter:function(t,r){if(this.tableDom||(this.tableDom=this.element.find("table")[0]),this.tableDom&&e.isFunction(r))for(var i=0;i<t.rows;i++)for(var n=0;n<t.cols;n++){var o=i+t.startRow+1,s=n+t.startCol;r(e(this.tableDom.rows[o].cells[s]),o,s,t)}},cellIter:function(e,t){this._cellIter(e,t)},_clearSelectedArea:function(){this.element.find(".cell.selected").removeClass("selected")},_createHelper:function(t){var r=this.element.find(".select-helper");return 0==r.length?r=e('<div class="select-helper"></div>').appendTo(this.element):r.show(),r},_computeHelperPos:function(e){var t=e.pageX,r=e.pageY,i=this.options.container?this.options.container.offset():this.element.offset(),n=this.dragElem.offset(),o=n.left>t?5:0,s=n.left>t?0:5,a=this.element.scrollLeft(),l=this.element.scrollTop();return{left:Math.min(n.left,t)-i.left+o+a,top:Math.min(n.top,r)-i.top+l,width:Math.abs(t-n.left)-s,height:Math.abs(r-n.top)}},_initAction:function(){this._on({click:function(){this._closeEditor()},"mouseout .cell .editor:not(.select-value)":function(t){var r=e(t.target).parents(".cell:first"),i=r.data("oldValue");this._closeEditor();var n=r.data("value")||r.text();(!i&&n||i!=n)&&(r.data("oldValue",n),r.trigger("cellChange",{oldValue:i,value:n}))},"click .cell .editor":function(){return!1},"click .cell .editor.select-value":function(t){return e(t.currentTarget).parents(".cell:first").trigger("click"),!1},"cellValue .cell":function(t,r){var i=e(t.currentTarget);(r.value||"0"==r.value)&&(r.text?i.hasClass("fieldSelect")?i.data("value",r.value).attr("data-value",r.value).empty().append('<span data-value="'+r.value+'" class="editor select-value">'+r.text+"</span>"):(i.data("value",r.value),i.text(r.text)):i.text(r.value))},"click .cell .option-item":function(t){var r=e(t.currentTarget),i=r.parents(".cell:first"),n=i.data("value"),o=r.data("value");if(i.data("value",o).attr("data-value",o).find("span.editor:first").text(r.text()),i.removeClass("open").removeClass("cell-editing"),i.is('[data-editor="fieldRadioGroup"]')){if(!0!==this.options.editable)return!1;r.addClass("icon-ok-circle").removeClass("icon-circle-blank"),i.find(".option-item").not(r).removeClass("icon-ok-circle").addClass("icon-circle-blank")}return(!n&&o||n!=o)&&i.trigger("cellChange",{oldValue:n,value:o}),!1},"click .cell":function(t){this._hiddenContextMenu();var r=e(t.target);return this._clickCell(r),!0!==this.options.editable||r.hasClass("readonly")?r.hasClass("readonly")&&this._closeEditor():this._openEditor(r),!1},"click .rowHeader":function(t){this._selectedRow(e(t.currentTarget).parent().prevAll().length+1)},"click .colHeader":function(t){this._selectedCol(e(t.currentTarget).prevAll().length)},"click .pubHeader":function(e){},"contextmenu .cell":function(t){if(this.options.xmenu){var r=e(t.currentTarget);return r.hasClass("catalog-value")?(r.trigger("contextmenuCatalog",{pageY:t.pageY,pageX:t.pageX}),!1):(r.hasClass("selected")||this._clickCell(r),this._showContextmenu(t,r),!1)}},"contextmenuAction .cell":function(e,t){t.name&&this.execCommand(e.currentTarget,{name:"xmenu_"+t.name,event:e})}})},_selectedRow:function(t){this._clearSelectedArea(),e(this.tableDom).find("tr:eq("+t+") td").addClass("selected"),this._selectAreaChanged()},_selectedCol:function(t){this._clearSelectedArea(),e(this.tableDom).find("tr").find("td:eq("+t+")").addClass("selected"),this._selectAreaChanged()},_clickCell:function(e){this._clearSelectedArea(),this.element.find(".cell.cell-click").not(e).removeClass("cell-click"),e.addClass("cell-click").addClass("selected"),this._selectAreaChanged()},_addAreaSytle:function(e,t){this._cellIter(e,function(e){e.addClass(t)}),this._selectAreaChanged()},_selectAreaChanged:function(){this._trigger("areaChange",{})},_openEditor:function(t){if(t.hasClass("cell-editing")||t.hasClass("conditional-item"))t.hasClass("fieldSelect")&&this._closeEditor();else{this._closeEditor();var r=t.data("value")||t.text();t.addClass("cell-editing").data("oldValue",r);var i=t.data("editor")||t.attr("data-editor")||"fieldText";if("fieldText"==i)t.hasClass("catalog-value")?e('<input style="width:100%;" class="editor fieldText" data-value="'+t.data("value")+'" value="'+t.text()+'"/>').appendTo(t.empty()).focus():e('<input style="width:100%;" class="editor fieldText" value="'+e.trim(r)+'"/>').appendTo(t.empty()).focus();else if("fieldRadioGroup"==i)e(function(e,t,r){var i=[];if(r&&t&&r[t])for(var n in r[t])i.push('<span class="option-item radio-item youi-icon icon-circle-blank" data-value="'+n+'">'+(r[t][n]||"")+"</span>");return i.join("")}(0,t.data("convert"),this.options.converts)).appendTo(t.empty()).focus();else if("fieldSelect"==i){t.addClass("open");var o=e(".editor.select-value:first",t),s={value:o.data("value"),text:o.text()};t.parent().prevAll().length>11?t.addClass("dropup"):t.addClass("dropdown"),e(function(t,r,i){var o=[];if(o.push('<span class="editor select-value" data-value="'+t.value+'" data-toggle="dropdown" aria-expanded="true">'+(t.text||"")+"</span>"),o.push('<ul class="dropdown-menu">'),o.push('<li class="option-item" data-value="">请选择</li>'),i&&r&&i[r]){var s=[];e.each(i[r],function(e,t){s[s.length]=e}),s.sort(n),e.each(s,function(e,t){o.push('<li class="option-item" data-value="'+t+'">'+t+" "+(i[r][t]||"")+"</li>")})}return o.push("</ul>"),o.join("")}(s,t.data("convert"),this.options.converts)).appendTo(t.empty()).focus()}else if("fieldAutocomplete"==i&&this.options.searchUrl){var a={id:t.data("editorId"),key:t.data("editorKey")},l=t.text(),d=e.youi.recordUtils.replaceByRecord(this.options.searchUrl,a),c=(this.options.searchValueAttr,this.options.searchTextAttr||"text"),h={url:d,notShowLoading:!0,success:function(t){var r=[];e(t.records).each(function(){r.push(e.extend({value:this[c],label:this[c]},this))}),this.response(r)}};e('<input style="width:100%;" class="editor select-value fieldAutocomplete" data-value="'+r+'" value="'+r+'"/>').appendTo(t.empty()).autocomplete({position:{my:"right bottom",at:"right top"},source:function(t,r){this.xhr&&this.xhr.abort(),this.xhr=e.youi.ajaxUtils.ajax(e.extend({data:t,response:r},h))},select:this._proxy("_itemValueSelect",t),close:this._proxy("_closeEditorBySelect",e.extend({},{cellElem:t,oldText:l}))})}}},_itemValueSelect:function(t,r,i){e(t.target).attr("data-value",r.item.value),r.cellElem=i,this._trigger("itemValueSelect",t,r)},_closeEditorBySelect:function(t,r,i){var n=e(t.target);e(i.cellElem).data("oldText",i.oldText),n.data("value")||n.val(""),this._closeEditor()},_closeEditor:function(){var t=e(".cell.cell-editing",this.tableDom),r=t.data("oldText")||"",n=e("input.editor",t),o=n.val()||"";if(t.length){if(t.find(".dropdown-menu").length)return void t.removeClass("cell-editing").removeClass("open");if("fieldAutocomplete"===t.data("editor")&&r&&(o=r),n.hasClass("select-value")&&"fieldAutocomplete"!==t.data("editor")&&(o=n.data("value")||""),t.removeClass("cell-editing").empty().text(o),o!==r){var s=e.extend({rowIndex:t.parent().prevAll().length,colIndex:t.prevAll().length},i(t));this._trigger("cellTextChange",null,{record:s,oldText:r})}}},_showContextmenu:function(t,r){var i=e("#"+this.options.xmenu);if(i.length){i.hasClass("hidden")&&i.removeClass("hidden");var n=i.parents(".page-container:first").offset(),o=r[0].className.split(" ");this.element.find(".cell.selected").length>1&&o.push("area"),i.trigger("open",{bind:r[0],left:t.pageX+10-n.left,top:t.pageY+10-n.top,groups:o})}},_hiddenContextMenu:function(){e("#"+this.options.xmenu).hide()},loadDatas:function(e,t,r){var i=['<table class="table">'];i.push(this._buildColHeaders(r)),i.push(this._buildBody(e,t,r)),i.push("</table>"),this.element.find("table").remove(),this.element.append(i.join("")),this.tableDom=this.element.find("table")[0]},fillRecords:function(t){if(e.isArray(t))for(var r=0;r<t.length;r++){var i=t[r];this._fillCellByRecord(i)}},_fillCellByRecord:function(t){if(t&&t.rowIndex>-1&&t.colIndex>-1){var i=e(this.tableDom.rows[t.rowIndex].cells[t.colIndex]),n=r(t);i.after(e(n)).remove()}},getActiveGroups:function(){var e=[],t=this.element.find(".selected").length;return t&&e.push("cell"),(this.element.find(".selected.merged-cell").length>0||t>1)&&e.push("merge"),e},loadXml:function(t){var r=['<table class="table">'];r.push(t),r.push("</table>"),this.element.find("table").remove(),this.element.append(r.join("")),this.tableDom=this.element.find("table")[0];var i=e("tbody",this.tableDom).data("colwidths").split(",");e(this.tableDom).prepend("</thead>"+this._buildColHeaders(i.length,i)+"</thead>"),e("tbody>tr",this.tableDom).each(function(t){e(this).prepend('<td class="rowHeader">'+(t+1)+"</td>")})},loadSheetHtml:function(e){this.element.html(e),this.tableDom=this.element.find("table")[0]},getSelectedArea:function(e,t){return this._selectedAreaIter()},getCellRecord:function(t){return e.extend({rowIndex:t.parent().prevAll().length,colIndex:t.prevAll().length},i(t))},processCellRecord:function(t,r){var i=e(this.tableDom.rows[t.rowIndex+1].cells[t.colIndex]);e.isFunction(r)&&r(t,i)},processArea:function(e,t){return this._cellAreaRecordsIter(e,t)},setCellText:function(t){e(this.tableDom.rows[t.rowIndex+1].cells[t.colIndex]).text(t.text)},insertRow:function(t,i){var n=this.tableDom.rows[0].cells.length-1,o=[""],s=(i=i||[],[]),a={},l=null;t.startRow+1<this.tableDom.rows.length-1&&(l=e(this.tableDom.rows[t.startRow+1]),e("td",l).each(function(r){var i=e(this).attr("data-merge-id");if(s[r]=i,i&&!a[i]){var n=e(".cell#"+i,this.parentNode.parentNode),o=parseInt(n.attr("rowspan"));n.attr("rowspan",o+t.rows),a[i]=i}}));for(var d=0;d<t.rows;d++){o.push('<tr class="rowTr"><td class="rowHeader"></td>');for(var c=0;c<n;c++){var h=e.extend({text:"",class:"cell",datas:{}},i[c]);s[c]&&(h.class="cell hide",h.datas.mergeId=s[c]),o.push(r(h))}o.push("</tr>")}return l?l.before(e(o.join(""))):e("tbody",this.tableDom).append(o.join("")),this._reBuildRowHeader(),t},appendRow:function(){var t=this.tableDom.rows[0].cells.length-1,i=[];i.push('<tr class="rowTr"><td class="rowHeader"></td>');for(var n=0;n<t;n++)i.push(r({class:"cell"}));i.push("</tr>"),e("tbody",this.tableDom).append(i.join("")),this._reBuildRowHeader()},reBuildRowHeader:function(){this._reBuildRowHeader()},insertRowHtmls:function(t,r){t.startRow+1<this.tableDom.rows.length-1?e(this.tableDom.rows[t.startRow+1]).before(e(r)):e("tbody",this.tableDom).append(e(r)),e("[data-old-rowspan]",this.tableDom).each(function(){var t=e(this),r=parseInt(t.attr("data-old-rowspan")),i=t.attr("data-merge-id");t.removeAttr("data-old-rowspan"),e("#"+i,t.parents("tbody:first")).attr("rowspan",r)}),this._reBuildRowHeader()},deleteRow:function(t){for(var r=e("<table></table>"),i=0;i<t.rows;i++)e(this.tableDom.rows[t.startRow+1]).appendTo(r);this._reBuildRowHeader();var n={};for(var o in r.find("[data-merge-id]").each(function(){var t=e(this).attr("data-merge-id");t&&!n[t]&&(n[t]=t)}),n){var s=e("#"+o,this.tableDom),a=parseInt(s.attr("rowspan")),l=s.parent().prevAll().length+a-1,d=0;t.endRow>l&&(d=t.endRow-l),s.attr("rowspan",a-t.rows+d),r.find("[data-merge-id="+o+"]:first").attr("data-old-rowspan",a)}var c=r.find("tbody").html();return r.remove(),c},insertCol:function(t,i){for(var n=this.tableDom.rows.length,o=t.startCol,s=(i=i||[],{}),a=0;a<n;a++){var l=[],d=e(this.tableDom.rows[a].cells[o]),c=d.attr("data-merge-id");if(d&&c){var h=s[c]||e("#"+c,this.tableDom);if(h.prevAll().length<=o){if(!s[c]){var u=parseInt(h.attr("colspan"));h.attr("colspan",u+t.cols)}}else c="";s[c]=h}for(var f=0;f<t.cols;f++)if(0===a)l.push('<th class="colHeader" style="width:100px;"></th>');else{var p=e.extend({text:"",class:"cell",datas:{}},i[a]);c&&(p.class="cell hide",p.datas.mergeId=c),l.push(r(p))}d.before(l.join(""))}return this._reBuildColHeader(),t},appendCol:function(){e("thead>tr",this.tableDom).append('<th class="colHeader"></th>'),e("tr.rowTr",this.tableDom).each(function(){e(this).append(r({class:"cell"}))}),this._reBuildColHeader()},appendBlankCol:function(){e(this.tableDom).addClass("tableNoBorder"),e("thead>tr",this.tableDom).append('<th class="blankHead"></th>'),e("tr.rowTr",this.tableDom).each(function(){e(this).append(r({class:"cell hide"}))}),this._reBuildColHeader()},deleteCol:function(t){for(var r=this.tableDom.rows.length,i={},n=[],o=t.startCol,s=0;s<r;s++){for(var a=e("<tr></tr>"),l=0;l<t.cols;l++){var d=e(this.tableDom.rows[s].cells[o]),c=d.attr("data-merge-id");if(c&&!i[c]){var h=e("#"+c,this.tableDom),u=parseInt(h.attr("colspan")),f=h.prevAll().length+u-1,p=0;t.endCol>f&&(p=t.endCol-f),h.attr("colspan",u-t.cols+p),d.attr("data-old-colspan",u),i[c]=c}a.append(d)}n.push(a.html()),a.remove()}return this._reBuildColHeader(),n},insertColHtmls:function(t,r){for(var i=this.tableDom.rows.length,n=t.startCol,o=this.tableDom.rows[0].cells.length===n,s=0;s<i;s++)o?e(this.tableDom.rows[s]).append(r[s]):e(this.tableDom.rows[s].cells[n]).before(r[s]),e("[data-old-colspan]",this.tableDom).each(function(){var t=e(this),r=parseInt(t.attr("data-old-colspan")),i=t.attr("data-merge-id");t.removeAttr("data-old-colspan"),e("#"+i,t.parents("tbody:first")).attr("colspan",r)});this._reBuildColHeader()},clearArea:function(t,r,i){return this._cellAreaRecordsIter(i,function(t,r,i,n){r.before(e('<td class="cell selected"></td>')).remove()})},clearAreaText:function(e,t,r){return this._cellAreaRecordsIter(r,function(e,t,r,i){t.text("")})},mergeArea:function(t,r,i){var n,o=!1,s=this._cellAreaRecordsIter(i,function(e,t,r,i){(t.hasClass("merged-cell")||t.is("[data-merge-id]"))&&(o=!0)});o?this._cellAreaRecordsIter(i,function(t,r,i,n){if(r.hasClass("merged-cell")){var o=r.attr("id");r.removeClass("merged-cell").removeAttr("id").removeAttr("rowspan").removeAttr("colspan"),e("[data-merge-id="+o+"]",r.parent().parent()).removeClass("hide").removeAttr("data-merge-id")}}):this._cellAreaRecordsIter(i,function(e,t,r,o){i.startRow===r-1&&i.startCol===o?(n="m_"+r+"_"+o+"_"+(new Date).getTime(),t.attr("id",n).addClass("merged-cell").attr("rowspan",i.rows).attr("colspan",i.cols).css("textAlign","center")):t.addClass("hide").attr("data-merge-id",n)});return s},setTextIndent:function(e,t,r){return this._cellAreaRecordsIter(r,function(e,r,i,n){r.css("textIndent",t.value)})},setAlign:function(e,t,r){return this._cellAreaRecordsIter(r,function(e,r,i,n){r.css("textAlign",t.value)})},setColor:function(e,t,r){return this._cellAreaRecordsIter(r,function(e,r,i,n){r.css("color",t.value)})},setBgColor:function(e,t,r){return this._cellAreaRecordsIter(r,function(e,r,i,n){r.css("backgroundColor",t.value)})},setFontSize:function(e,t,r){return this._cellAreaRecordsIter(r,function(e,r,i,n){r.css("fontSize",t.value)})},setSequence:function(e,t,r){var i=0;return this._cellAreaRecordsIter(r,function(e,t,r,n){t.text(++i)})},setBorder:function(t,r,i){var n=e.extend({},i,{startRow:i.startRow>0?i.startRow-1:i.startRow,startCol:i.startCol>1?i.startCol-1:i.startCol});if(n.cols=n.endCol-n.startCol+1,n.rows=n.endRow-n.startRow+1,"outerBorder"===r.value)return this._setOuterBorder(i,n);var o=r.value.split(",");return this._cellAreaRecordsIter(n,function(e,t,s,a){if(s!==i.startRow||a!==i.startCol-1)if(s===i.startRow)"1"===o[0]?t.css("borderBottomColor","black"):"0,0,0,0"==r.value&&t.css("borderBottomColor","");else if(a===i.startCol-1&&s>i.startRow)"1"==o[3]?t.css("borderRightColor","black"):"0,0,0,0"==r.value&&t.css("borderRightColor","");else if(s>i.startRow-1&&a>i.startCol-1){var l={borderRightColor:"",borderBottomColor:""};"1"===o[0]&&n.startRow!=s&&"1,0,0,0"==r.value&&i.endRow>=s&&(l.borderBottomColor="black"),"1"===o[1]&&(l.borderRightColor="black"),"1"===o[2]&&(l.borderBottomColor="black"),"1"===o[3]&&n.startCol!=a&&"0,0,0,1"==r.value&&i.endCol>a&&(l.borderRightColor="black"),t.css(l)}})},_setOuterBorder:function(e,t){return this._cellAreaRecordsIter(t,function(r,i,n,o){o>e.startCol-1&&(n===e.startRow||n===e.endRow+1)&&i.css("borderBottomColor","black"),n>e.startRow&&(o===t.startCol&&e.startCol!=t.startCol||o===t.endCol)&&i.css("borderRightColor","black")})},_selectedAreaIter:function(t){var r=e(".selected.cell:first",this.tableDom),i=e(".selected.cell:last",this.tableDom);return this._cellAreaIter(r,i,t)},buildXml:function(t){var n=[],o=[];for(var s in this.element.find("thead .colHeader").not(".pubHeader").each(function(){o.push(e(this).outerWidth())}),t=e.extend({},t,{colWidths:o.join()}),n.push("<tbody "),t)t[s]&&n.push("data-"+s+'="'+t[s]+'" ');return n.push(">"),this.element.find(".rowTr").each(function(){var t=[];e(this).find(".cell").each(function(){t.push(r(i(e(this))))}),t.length&&(n.push('<tr class="rowTr">'),(n=n.concat(t)).push("</tr>"))}),n.push("</tbody>"),n.join("")},_isEmptyRow:function(t){return!e(t.text())},_buildColHeaders:function(e,r){var i=[];r=r||[];i.push('<thead><tr><th style="width:25px;" class="pubHeader">&nbsp;</th>');for(var n=0;n<e;n++)i.push('<th class="colHeader" style="width:'+(r[n]||100)+'px">'+t(n+1)+' <span class="col-resize-handler pull-right"></span></th>');return i.push("</tr></thead>"),i.join("")},_buildBody:function(e,t,r){for(var i=["<tbody>"],n=0;n<t;n++){i.push('<tr class="rowTr"><td class="rowHeader">'+(n+1)+"</td>");for(var o=0;o<r;o++)i.push('<td class="cell"></td>');i.push("</tr>")}return i.push("</tbody>"),i.join("")},rebuildTable:function(){var t=0;this.element.find("table").find("tr").each(function(){var r=e(this)[0].cells.length;r>t&&(t=r)});var r=this._buildCell("");this.element.find("table").find("tr").each(function(){for(var i=e(this)[0].cells.length,n=t-i,o=i-1;n>0;)e(this).find("th:eq("+o+")").each(function(){e(this).after('<th class="colHeader"></th>')}),e(this).find("td:eq("+o+")").each(function(){e(this).after(r)}),n-=1}),this.removeLastEmptyCol(),this._reBuildRowHeader(),this._reBuildColHeader()},_removeLastEmptyRow:function(){for(var t=this.getLastEmptyRowIndex(),r=this.element.find("table")[0].rows.length;r>t;)this.element.find("table").find("tr:eq("+r+")").each(function(){e(this).remove()}),r-=1},removeLastEmptyCol:function(){for(var t=this.getLastEmptyColIndex(),r=this.element.find("table").find(".rowHeader").length;t<r;)r-=1,this.element.find("table").find("tr").find("th:eq("+r+")").each(function(){e(this).remove()}),this.element.find("table").find("tr").find("td:eq("+r+")").each(function(){e(this).remove()})},getLastEmptyRowIndex:function(){var t=1,r=1;return this.element.find(".rowTr").each(function(){var i=!1;e(this).find(".cell").each(function(){e(this).data("group")&&(i=!0),e(this).data("expression")&&(i=!0),e(this).text()&&(i=!0)}),i&&(r=t),t+=1}),r},getLastEmptyColIndex:function(){var t=1;return this.element.find(".rowTr").each(function(){var r=!1,i=1;e(this).find(".cell").each(function(){e(this).data("group")&&(r=!0),e(this).data("expression")&&(r=!0),e(this).text()&&(r=!0),r&&(i=e(this)[0].cellIndex+1)}),t<i&&(t=i)}),t},_reBuildRowHeader:function(){this.element.find("table").find(".rowHeader").each(function(t){e(this).text(t+1)})},_reBuildColHeader:function(){this.element.find("table").find(".colHeader").not(".pubHeader").each(function(r){e(this).html(t(r+1)+'<span class="col-resize-handler pull-right"></span>')})},_destroy:function(){this.tableDom=null,this.pasteHelper&&this.pasteHelper.remove(),this.pasteHelper=null},setEditable:function(e){this.options.editable=e},getEditable:function(){return this.options.editable},xmenu_paste:function(e,t){this.pasteHelper.trigger("paste")},_resize:function(){}}))}(jQuery)},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){}]);